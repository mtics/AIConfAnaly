<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AIè®ºæ–‡æ·±åº¦åˆ†æ - ç»Ÿä¸€ä»ªè¡¨æ¿</title>
    <script src="https://cdn.jsdelivr.net/npm/echarts@5.4.0/dist/echarts.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Helvetica Neue', Arial, sans-serif;
        }

        body {
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            color: #2c3e50;
            line-height: 1.5;
            min-height: 100vh;
        }

        .main-container {
            max-width: 1600px;
            margin: 0 auto;
            padding: 15px;
        }

        .header {
            text-align: center;
            margin-bottom: 25px;
            background: white;
            padding: 20px;
            border-radius: 12px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.08);
        }

        .header h1 {
            font-size: 2.2em;
            color: #2c3e50;
            margin-bottom: 8px;
            font-weight: 600;
        }

        .header .subtitle {
            color: #7f8c8d;
            font-size: 1.1em;
        }

        /* å…³é”®æŒ‡æ ‡æ¦‚è§ˆ */
        .metrics-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(160px, 1fr));
            gap: 12px;
            margin-bottom: 20px;
        }

        .metric-card {
            background: white;
            padding: 18px;
            border-radius: 10px;
            text-align: center;
            box-shadow: 0 3px 12px rgba(0,0,0,0.06);
            border-left: 4px solid #3498db;
            transition: transform 0.2s ease;
        }

        .metric-card:hover {
            transform: translateY(-2px);
        }

        .metric-value {
            font-size: 1.8em;
            font-weight: bold;
            color: #2c3e50;
            display: block;
        }

        .metric-label {
            color: #7f8c8d;
            font-size: 0.9em;
            margin-top: 4px;
        }

        /* ä¸»è¦åˆ†æåŒºåŸŸ */
        .analysis-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-bottom: 20px;
        }

        .chart-panel {
            background: white;
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.08);
        }

        .panel-title {
            font-size: 1.1em;
            font-weight: 600;
            color: #2c3e50;
            margin-bottom: 15px;
            padding-bottom: 8px;
            border-bottom: 2px solid #ecf0f1;
        }

        .chart-container {
            height: 280px;
        }

        /* è¯¦ç»†åˆ†ææ ‡ç­¾ */
        .detail-panel {
            background: white;
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.08);
        }

        .tabs-container {
            display: flex;
            margin-bottom: 20px;
            background: #f8f9fa;
            border-radius: 8px;
            padding: 4px;
        }

        .tab-btn {
            flex: 1;
            padding: 12px;
            text-align: center;
            background: transparent;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 500;
            transition: all 0.3s ease;
            color: #7f8c8d;
        }

        .tab-btn.active {
            background: #3498db;
            color: white;
            box-shadow: 0 2px 8px rgba(52, 152, 219, 0.3);
        }

        .tab-content {
            display: none;
            min-height: 300px;
        }

        .tab-content.active {
            display: block;
        }

        /* ç»Ÿè®¡åˆ—è¡¨æ ·å¼ */
        .stats-list {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
        }

        .stat-item {
            padding: 15px;
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            border-radius: 8px;
            border-left: 4px solid #3498db;
        }

        .stat-name {
            font-weight: 600;
            color: #2c3e50;
            margin-bottom: 5px;
        }

        .stat-value {
            color: #7f8c8d;
            font-size: 0.9em;
        }

        /* å“åº”å¼è®¾è®¡ */
        @media (max-width: 1200px) {
            .analysis-grid {
                grid-template-columns: 1fr;
            }
        }

        @media (max-width: 768px) {
            .metrics-grid {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .header h1 {
                font-size: 1.8em;
            }
            
            .tabs-container {
                flex-direction: column;
                gap: 4px;
            }
        }

        /* åŠ è½½çŠ¶æ€ */
        .loading {
            text-align: center;
            padding: 40px;
            color: #7f8c8d;
        }

        .loading-spinner {
            width: 40px;
            height: 40px;
            border: 4px solid #ecf0f1;
            border-left: 4px solid #3498db;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto 15px;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* å›¾è¡¨æ‚¬æµ®æç¤ºä¼˜åŒ– */
        .chart-tooltip {
            background: rgba(255, 255, 255, 0.95) !important;
            border: 1px solid #ddd !important;
            border-radius: 6px !important;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15) !important;
        }
    </style>
</head>
<body>
    <div class="main-container">
        <!-- æ ‡é¢˜åŒºåŸŸ -->
        <div class="header">
            <h1>ğŸš€ AIä¼šè®®è®ºæ–‡æ·±åº¦åˆ†æä»ªè¡¨æ¿</h1>
            <div class="subtitle">åŸºäºç»†åŒ–åœºæ™¯è¯†åˆ«çš„æ™ºèƒ½åˆ†æç³»ç»Ÿ</div>
        </div>

        <!-- åŠ è½½çŠ¶æ€ -->
        <div id="loadingIndicator" class="loading">
            <div class="loading-spinner"></div>
            <div>æ­£åœ¨åŠ è½½åˆ†ææ•°æ®...</div>
        </div>

        <!-- ä¸»è¦å†…å®¹ -->
        <div id="mainContent" style="display: none;">
            <!-- å…³é”®æŒ‡æ ‡æ¦‚è§ˆ -->
            <div class="metrics-grid">
                <div class="metric-card">
                    <span class="metric-value" id="totalPapers">0</span>
                    <div class="metric-label">æ€»è®ºæ–‡æ•°</div>
                </div>
                <div class="metric-card">
                    <span class="metric-value" id="timeSpan">0å¹´</span>
                    <div class="metric-label">æ—¶é—´è·¨åº¦</div>
                </div>
                <div class="metric-card">
                    <span class="metric-value" id="conferenceCount">0</span>
                    <div class="metric-label">è¦†ç›–ä¼šè®®</div>
                </div>
                <div class="metric-card">
                    <span class="metric-value" id="scenarioCount">0</span>
                    <div class="metric-label">åº”ç”¨åœºæ™¯</div>
                </div>
                <div class="metric-card">
                    <span class="metric-value" id="techTrendCount">0</span>
                    <div class="metric-label">æŠ€æœ¯è¶‹åŠ¿</div>
                </div>
                <div class="metric-card">
                    <span class="metric-value" id="growthRate">0%</span>
                    <div class="metric-label">å¹´å¢é•¿ç‡</div>
                </div>
            </div>

            <!-- ä¸»è¦å›¾è¡¨åˆ†æ -->
            <div class="analysis-grid">
                <!-- å¹´åº¦å‘è¡¨è¶‹åŠ¿ -->
                <div class="chart-panel">
                    <div class="panel-title">ğŸ“ˆ å¹´åº¦å‘è¡¨è¶‹åŠ¿</div>
                    <div class="chart-container" id="yearlyTrendChart"></div>
                </div>

                <!-- ä¼šè®®åˆ†å¸ƒ -->
                <div class="chart-panel">
                    <div class="panel-title">ğŸ›ï¸ ä¼šè®®åˆ†å¸ƒæ¦‚è§ˆ</div>
                    <div class="chart-container" id="conferenceDistChart"></div>
                </div>

                <!-- åº”ç”¨åœºæ™¯åˆ†å¸ƒ -->
                <div class="chart-panel">
                    <div class="panel-title">ğŸ¯ ç»†åŒ–åº”ç”¨åœºæ™¯åˆ†å¸ƒ</div>
                    <div class="chart-container" id="scenarioDistChart"></div>
                </div>

                <!-- æŠ€æœ¯è¶‹åŠ¿åˆ†å¸ƒ -->
                <div class="chart-panel">
                    <div class="panel-title">ğŸ”¬ æŠ€æœ¯å‘å±•è¶‹åŠ¿</div>
                    <div class="chart-container" id="techTrendChart"></div>
                </div>
            </div>

            <!-- è¯¦ç»†åˆ†æé¢æ¿ -->
            <div class="detail-panel">
                <div class="panel-title">ğŸ“Š æ·±åº¦åˆ†ææ´å¯Ÿ</div>
                
                <!-- æ ‡ç­¾é¡µå¯¼èˆª -->
                <div class="tabs-container">
                    <button class="tab-btn active" onclick="switchTab('scenarios')">åº”ç”¨åœºæ™¯ç»†åˆ†</button>
                    <button class="tab-btn" onclick="switchTab('technology')">æŠ€æœ¯æ¼”è¿›åˆ†æ</button>
                    <button class="tab-btn" onclick="switchTab('tasks')">ä»»åŠ¡ç±»å‹åˆ†å¸ƒ</button>
                    <button class="tab-btn" onclick="switchTab('trends')">æ–°å…´è¶‹åŠ¿è¯†åˆ«</button>
                    <button class="tab-btn" onclick="switchTab('insights')">å…³é”®æ´å¯Ÿ</button>
                </div>

                <!-- åº”ç”¨åœºæ™¯ç»†åˆ† -->
                <div id="scenarios" class="tab-content active">
                    <div class="chart-container" id="detailedScenariosChart"></div>
                </div>

                <!-- æŠ€æœ¯æ¼”è¿›åˆ†æ -->
                <div id="technology" class="tab-content">
                    <div class="chart-container" id="techEvolutionChart"></div>
                </div>

                <!-- ä»»åŠ¡ç±»å‹åˆ†å¸ƒ -->
                <div id="tasks" class="tab-content">
                    <div class="chart-container" id="taskTypesChart"></div>
                </div>

                <!-- æ–°å…´è¶‹åŠ¿è¯†åˆ« -->
                <div id="trends" class="tab-content">
                    <div class="stats-list" id="emergingTrendsList"></div>
                </div>

                <!-- å…³é”®æ´å¯Ÿ -->
                <div id="insights" class="tab-content">
                    <div class="stats-list" id="keyInsightsList"></div>
                </div>
            </div>
        </div>
    </div>

    <script>
        let analysisData = null;
        let charts = {};

        // é¡µé¢åŠ è½½å®Œæˆååˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', async function() {
            try {
                await loadData();
                initializeDashboard();
                hideLoading();
            } catch (error) {
                console.error('åˆå§‹åŒ–å¤±è´¥:', error);
                showError('æ•°æ®åŠ è½½å¤±è´¥: ' + error.message);
            }
        });

        // æ•°æ®åŠ è½½
        async function loadData() {
            try {
                if (window.embeddedAnalysisData) {
                    analysisData = window.embeddedAnalysisData;
                } else {
                    const response = await fetch('../outputs/analysis/comprehensive_analysis.json');
                    if (!response.ok) throw new Error(`HTTP ${response.status}`);
                    analysisData = await response.json();
                }
            } catch (error) {
                throw new Error('æ— æ³•åŠ è½½åˆ†ææ•°æ®');
            }
        }

        // åˆå§‹åŒ–ä»ªè¡¨æ¿
        function initializeDashboard() {
            updateMetrics();
            initializeCharts();
            populateDetailedAnalysis();
            document.getElementById('mainContent').style.display = 'block';
        }

        // æ›´æ–°å…³é”®æŒ‡æ ‡
        function updateMetrics() {
            const basic = analysisData.basic_statistics || {};
            const temporal = analysisData.temporal_analysis || {};
            const scenarios = analysisData.task_scenario_analysis || {};
            const techTrends = analysisData.technical_trend_analysis || {};

            document.getElementById('totalPapers').textContent = 
                (basic.total_papers || 0).toLocaleString();
            
            document.getElementById('timeSpan').textContent = 
                basic.year_range ? `${basic.year_range[1] - basic.year_range[0] + 1}å¹´` : '0å¹´';
            
            document.getElementById('conferenceCount').textContent = 
                (basic.conferences?.length || 0);
            
            document.getElementById('scenarioCount').textContent = 
                (scenarios.top_scenarios?.length || 0);
            
            document.getElementById('techTrendCount').textContent = 
                (techTrends.top_technical_trends?.length || 0);
            
            document.getElementById('growthRate').textContent = 
                temporal.total_growth_rate ? `${temporal.total_growth_rate.toFixed(1)}%` : '0%';
        }

        // åˆå§‹åŒ–å›¾è¡¨
        function initializeCharts() {
            // å¹´åº¦è¶‹åŠ¿å›¾
            initYearlyTrendChart();
            
            // ä¼šè®®åˆ†å¸ƒå›¾
            initConferenceDistChart();
            
            // åº”ç”¨åœºæ™¯åˆ†å¸ƒå›¾
            initScenarioDistChart();
            
            // æŠ€æœ¯è¶‹åŠ¿å›¾
            initTechTrendChart();
            
            // è¯¦ç»†åœºæ™¯åˆ†æå›¾
            initDetailedScenariosChart();
            
            // æŠ€æœ¯æ¼”è¿›å›¾
            initTechEvolutionChart();
            
            // ä»»åŠ¡ç±»å‹å›¾
            initTaskTypesChart();
        }

        // å¹´åº¦è¶‹åŠ¿å›¾
        function initYearlyTrendChart() {
            const chartDom = document.getElementById('yearlyTrendChart');
            const chart = echarts.init(chartDom);
            charts.yearlyTrend = chart;

            const temporal = analysisData.temporal_analysis || {};
            const yearlyData = temporal.yearly_paper_counts || {};
            
            const years = Object.keys(yearlyData).sort();
            const counts = years.map(year => yearlyData[year]);

            const option = {
                tooltip: {
                    trigger: 'axis',
                    backgroundColor: 'rgba(255,255,255,0.95)',
                    borderColor: '#3498db',
                    borderWidth: 1,
                    textStyle: { color: '#2c3e50' }
                },
                grid: { top: 20, left: 40, right: 20, bottom: 30 },
                xAxis: {
                    type: 'category',
                    data: years,
                    axisLine: { lineStyle: { color: '#bdc3c7' } },
                    axisLabel: { color: '#7f8c8d' }
                },
                yAxis: {
                    type: 'value',
                    axisLine: { lineStyle: { color: '#bdc3c7' } },
                    axisLabel: { color: '#7f8c8d' },
                    splitLine: { lineStyle: { color: '#ecf0f1' } }
                },
                series: [{
                    data: counts,
                    type: 'line',
                    smooth: true,
                    lineStyle: { color: '#3498db', width: 3 },
                    itemStyle: { color: '#3498db' },
                    areaStyle: {
                        color: {
                            type: 'linear',
                            x: 0, y: 0, x2: 0, y2: 1,
                            colorStops: [
                                { offset: 0, color: 'rgba(52, 152, 219, 0.3)' },
                                { offset: 1, color: 'rgba(52, 152, 219, 0.1)' }
                            ]
                        }
                    }
                }]
            };

            chart.setOption(option);
        }

        // ä¼šè®®åˆ†å¸ƒå›¾
        function initConferenceDistChart() {
            const chartDom = document.getElementById('conferenceDistChart');
            const chart = echarts.init(chartDom);
            charts.conferenceDist = chart;

            const basic = analysisData.basic_statistics || {};
            const confCounts = basic.conference_counts || {};
            
            const data = Object.entries(confCounts)
                .map(([name, value]) => ({ name, value }))
                .sort((a, b) => b.value - a.value);

            const option = {
                tooltip: {
                    trigger: 'item',
                    formatter: '{b}: {c} ({d}%)',
                    backgroundColor: 'rgba(255,255,255,0.95)',
                    borderColor: '#3498db'
                },
                series: [{
                    type: 'pie',
                    radius: ['30%', '70%'],
                    data: data,
                    itemStyle: {
                        borderRadius: 5,
                        borderColor: '#fff',
                        borderWidth: 2
                    },
                    label: {
                        show: true,
                        position: 'outside',
                        formatter: '{b}\n{d}%'
                    },
                    emphasis: {
                        itemStyle: {
                            shadowBlur: 10,
                            shadowOffsetX: 0,
                            shadowColor: 'rgba(0, 0, 0, 0.3)'
                        }
                    }
                }]
            };

            chart.setOption(option);
        }

        // åº”ç”¨åœºæ™¯åˆ†å¸ƒå›¾
        function initScenarioDistChart() {
            const chartDom = document.getElementById('scenarioDistChart');
            const chart = echarts.init(chartDom);
            charts.scenarioDist = chart;

            const scenarios = analysisData.task_scenario_analysis || {};
            const scenarioData = scenarios.scenario_distribution || {};
            
            const data = Object.entries(scenarioData)
                .sort(([,a], [,b]) => b - a)
                .slice(0, 8); // æ˜¾ç¤ºå‰8ä¸ª

            const option = {
                tooltip: {
                    trigger: 'axis',
                    backgroundColor: 'rgba(255,255,255,0.95)',
                    borderColor: '#3498db'
                },
                grid: { top: 20, left: 10, right: 20, bottom: 80 },
                xAxis: {
                    type: 'category',
                    data: data.map(([name]) => name.split(' ')[0] + '...'),
                    axisLabel: { 
                        color: '#7f8c8d',
                        rotate: 45,
                        interval: 0
                    }
                },
                yAxis: {
                    type: 'value',
                    axisLabel: { color: '#7f8c8d' },
                    splitLine: { lineStyle: { color: '#ecf0f1' } }
                },
                series: [{
                    type: 'bar',
                    data: data.map(([, value]) => value),
                    itemStyle: {
                        color: {
                            type: 'linear',
                            x: 0, y: 1, x2: 0, y2: 0,
                            colorStops: [
                                { offset: 0, color: '#3498db' },
                                { offset: 1, color: '#5dade2' }
                            ]
                        }
                    }
                }]
            };

            chart.setOption(option);
        }

        // æŠ€æœ¯è¶‹åŠ¿å›¾
        function initTechTrendChart() {
            const chartDom = document.getElementById('techTrendChart');
            const chart = echarts.init(chartDom);
            charts.techTrend = chart;

            const techTrends = analysisData.technical_trend_analysis || {};
            const trendData = techTrends.trend_distribution || {};
            
            const data = Object.entries(trendData)
                .sort(([,a], [,b]) => b - a)
                .slice(0, 8); // æ˜¾ç¤ºå‰8ä¸ª

            const option = {
                tooltip: {
                    trigger: 'axis',
                    backgroundColor: 'rgba(255,255,255,0.95)',
                    borderColor: '#e74c3c'
                },
                grid: { top: 20, left: 10, right: 20, bottom: 80 },
                xAxis: {
                    type: 'category',
                    data: data.map(([name]) => name.split(' ')[0] + '...'),
                    axisLabel: { 
                        color: '#7f8c8d',
                        rotate: 45,
                        interval: 0
                    }
                },
                yAxis: {
                    type: 'value',
                    axisLabel: { color: '#7f8c8d' },
                    splitLine: { lineStyle: { color: '#ecf0f1' } }
                },
                series: [{
                    type: 'bar',
                    data: data.map(([, value]) => value),
                    itemStyle: {
                        color: {
                            type: 'linear',
                            x: 0, y: 1, x2: 0, y2: 0,
                            colorStops: [
                                { offset: 0, color: '#e74c3c' },
                                { offset: 1, color: '#ec7063' }
                            ]
                        }
                    }
                }]
            };

            chart.setOption(option);
        }

        // è¯¦ç»†åœºæ™¯åˆ†æå›¾
        function initDetailedScenariosChart() {
            const chartDom = document.getElementById('detailedScenariosChart');
            const chart = echarts.init(chartDom);
            charts.detailedScenarios = chart;

            const scenarios = analysisData.task_scenario_analysis || {};
            const scenarioData = scenarios.scenario_distribution || {};
            
            const data = Object.entries(scenarioData)
                .sort(([,a], [,b]) => b - a)
                .slice(0, 15); // æ˜¾ç¤ºå‰15ä¸ªè¯¦ç»†åœºæ™¯

            const option = {
                tooltip: {
                    trigger: 'axis',
                    backgroundColor: 'rgba(255,255,255,0.95)',
                    borderColor: '#9b59b6'
                },
                grid: { top: 20, left: 200, right: 20, bottom: 30 },
                xAxis: {
                    type: 'value',
                    axisLabel: { color: '#7f8c8d' },
                    splitLine: { lineStyle: { color: '#ecf0f1' } }
                },
                yAxis: {
                    type: 'category',
                    data: data.map(([name]) => name.length > 25 ? name.substring(0, 25) + '...' : name),
                    axisLabel: { color: '#7f8c8d' }
                },
                series: [{
                    type: 'bar',
                    data: data.map(([, value]) => value),
                    itemStyle: {
                        color: {
                            type: 'linear',
                            x: 0, y: 0, x2: 1, y2: 0,
                            colorStops: [
                                { offset: 0, color: '#9b59b6' },
                                { offset: 1, color: '#bb8fce' }
                            ]
                        }
                    }
                }]
            };

            chart.setOption(option);
        }

        // æŠ€æœ¯æ¼”è¿›å›¾
        function initTechEvolutionChart() {
            const chartDom = document.getElementById('techEvolutionChart');
            const chart = echarts.init(chartDom);
            charts.techEvolution = chart;

            const techTrends = analysisData.technical_trend_analysis || {};
            const maturityScores = techTrends.technology_maturity_scores || {};
            
            const data = Object.entries(maturityScores)
                .sort(([,a], [,b]) => b - a)
                .slice(0, 12);

            const option = {
                tooltip: {
                    trigger: 'item',
                    formatter: '{b}: {c}%',
                    backgroundColor: 'rgba(255,255,255,0.95)'
                },
                radar: {
                    indicator: data.map(([name]) => ({
                        name: name.length > 15 ? name.substring(0, 15) + '...' : name,
                        max: 1
                    })),
                    radius: '70%'
                },
                series: [{
                    type: 'radar',
                    data: [{
                        value: data.map(([, score]) => score),
                        itemStyle: { color: '#f39c12' },
                        areaStyle: { color: 'rgba(243, 156, 18, 0.3)' }
                    }]
                }]
            };

            chart.setOption(option);
        }

        // ä»»åŠ¡ç±»å‹å›¾
        function initTaskTypesChart() {
            const chartDom = document.getElementById('taskTypesChart');
            const chart = echarts.init(chartDom);
            charts.taskTypes = chart;

            const scenarios = analysisData.task_scenario_analysis || {};
            const taskData = scenarios.task_type_distribution || {};
            
            const data = Object.entries(taskData)
                .map(([name, value]) => ({ name, value }))
                .sort((a, b) => b.value - a.value);

            const option = {
                tooltip: {
                    trigger: 'item',
                    formatter: '{b}: {c} ({d}%)',
                    backgroundColor: 'rgba(255,255,255,0.95)'
                },
                series: [{
                    type: 'pie',
                    radius: '60%',
                    data: data,
                    roseType: 'radius',
                    itemStyle: {
                        borderRadius: 5
                    },
                    label: {
                        show: true,
                        position: 'outside'
                    }
                }]
            };

            chart.setOption(option);
        }

        // å¡«å……è¯¦ç»†åˆ†ææ•°æ®
        function populateDetailedAnalysis() {
            populateEmergingTrends();
            populateKeyInsights();
        }

        // å¡«å……æ–°å…´è¶‹åŠ¿
        function populateEmergingTrends() {
            const container = document.getElementById('emergingTrendsList');
            const emerging = analysisData.emerging_trends || {};
            const techTrends = analysisData.technical_trend_analysis || {};
            
            let html = '';
            
            // æ–°å…´åº”ç”¨åœºæ™¯
            const emergingScenarios = emerging.emerging_application_scenarios || {};
            Object.entries(emergingScenarios).slice(0, 6).forEach(([scenario, data]) => {
                html += `
                    <div class="stat-item">
                        <div class="stat-name">ğŸš€ ${scenario}</div>
                        <div class="stat-value">å¢é•¿ç‡: +${data.growth_rate}% | è¿‘æœŸè®ºæ–‡: ${data.recent_papers}ç¯‡</div>
                    </div>
                `;
            });
            
            // æ–°å…´æŠ€æœ¯
            const emergingTech = techTrends.emerging_technologies || {};
            Object.entries(emergingTech).slice(0, 6).forEach(([tech, data]) => {
                html += `
                    <div class="stat-item">
                        <div class="stat-name">âš¡ ${tech}</div>
                        <div class="stat-value">å¢é•¿ç‡: +${data.growth_rate}% | è¿‘æœŸè®ºæ–‡: ${data.recent_papers}ç¯‡</div>
                    </div>
                `;
            });
            
            container.innerHTML = html;
        }

        // å¡«å……å…³é”®æ´å¯Ÿ
        function populateKeyInsights() {
            const container = document.getElementById('keyInsightsList');
            const basic = analysisData.basic_statistics || {};
            const temporal = analysisData.temporal_analysis || {};
            const quality = analysisData.quality_metrics || {};
            const prediction = analysisData.prediction_insights || {};
            
            let html = `
                <div class="stat-item">
                    <div class="stat-name">ğŸ“Š æ•°æ®å®Œæ•´æ€§</div>
                    <div class="stat-value">è´¨é‡è¯„åˆ†: ${quality.data_quality_score?.toFixed(1) || 0}/100</div>
                </div>
                <div class="stat-item">
                    <div class="stat-name">ğŸ“ˆ å‘å±•è¶‹åŠ¿</div>
                    <div class="stat-value">å³°å€¼å¹´ä»½: ${temporal.peak_year || 'N/A'} (${temporal.peak_count?.toLocaleString() || 0}ç¯‡)</div>
                </div>
                <div class="stat-item">
                    <div class="stat-name">ğŸ”® 2025å¹´é¢„æµ‹</div>
                    <div class="stat-value">é¢„è®¡è®ºæ–‡æ•°: ${prediction.predicted_2025_papers?.toLocaleString() || 'N/A'}ç¯‡</div>
                </div>
                <div class="stat-item">
                    <div class="stat-name">ğŸ›ï¸ é¡¶çº§ä¼šè®®</div>
                    <div class="stat-value">${analysisData.conference_analysis?.top_conferences?.slice(0,3).join(', ') || 'N/A'}</div>
                </div>
                <div class="stat-item">
                    <div class="stat-name">ğŸ¯ åˆ†æè¦†ç›–</div>
                    <div class="stat-value">åœºæ™¯åˆ†æ: ${quality.analysis_coverage?.with_scenario_analysis?.toFixed(1) || 0}%</div>
                </div>
                <div class="stat-item">
                    <div class="stat-name">ğŸ“š ç ”ç©¶å¤šæ ·æ€§</div>
                    <div class="stat-value">å¤šæ ·æ€§æŒ‡æ•°: ${analysisData.field_analysis?.field_diversity_index?.toFixed(3) || 0}</div>
                </div>
            `;
            
            container.innerHTML = html;
        }

        // æ ‡ç­¾é¡µåˆ‡æ¢
        function switchTab(tabName) {
            // éšè—æ‰€æœ‰å†…å®¹
            document.querySelectorAll('.tab-content').forEach(content => {
                content.classList.remove('active');
            });
            
            // ç§»é™¤æ‰€æœ‰æŒ‰é’®çš„æ¿€æ´»çŠ¶æ€
            document.querySelectorAll('.tab-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            
            // æ˜¾ç¤ºé€‰ä¸­çš„å†…å®¹
            document.getElementById(tabName).classList.add('active');
            
            // æ¿€æ´»å¯¹åº”æŒ‰é’®
            event.target.classList.add('active');
            
            // é‡æ–°è°ƒæ•´å›¾è¡¨å¤§å°
            setTimeout(() => {
                Object.values(charts).forEach(chart => {
                    if (chart && chart.resize) {
                        chart.resize();
                    }
                });
            }, 100);
        }

        // éšè—åŠ è½½çŠ¶æ€
        function hideLoading() {
            document.getElementById('loadingIndicator').style.display = 'none';
        }

        // æ˜¾ç¤ºé”™è¯¯ä¿¡æ¯
        function showError(message) {
            document.getElementById('loadingIndicator').innerHTML = `
                <div style="color: #e74c3c;">
                    <div style="font-size: 1.2em; margin-bottom: 10px;">âš ï¸ åŠ è½½å¤±è´¥</div>
                    <div>${message}</div>
                </div>
            `;
        }

        // å“åº”å¼å¤„ç†
        window.addEventListener('resize', function() {
            Object.values(charts).forEach(chart => {
                if (chart && chart.resize) {
                    chart.resize();
                }
            });
        });

        // é¡µé¢å¯è§æ€§å˜åŒ–æ—¶é‡æ–°è°ƒæ•´
        document.addEventListener('visibilitychange', function() {
            if (!document.hidden) {
                setTimeout(() => {
                    Object.values(charts).forEach(chart => {
                        if (chart && chart.resize) {
                            chart.resize();
                        }
                    });
                }, 100);
            }
        });
    </script>
</body>
</html>